package com.serverapp.service.implement;

import com.google.gson.Gson;
import com.serverapp.enums.RequestType;
import com.serverapp.model.ClamAV;
import com.serverapp.service.IDetectMalware;
import com.serverapp.socket.SocketManager;
import com.serverapp.util.CurrentType;

import java.net.Socket;
import java.util.List;

public class DetectMalware implements IDetectMalware {
    private Boolean isRunning;

    public DetectMalware() {
        isRunning = false;
    }

    @Override
    public void start() {
    }

    //Listenning for response from Clients
    @Override
    public void listening() {
    }

    @Override
    public void logResult() {
        //Show result
    }

    public void send(List<String> checkedClient, ClamAV clamAV) {
        Gson gson = new Gson();
        checkedClient.forEach((item) -> {
            String message = gson.toJson(clamAV);
            try {
                SocketManager.getInstance().sendCurrentRequestType(item);
                SocketManager.getInstance().sendEncryptedMessage(message, item);
            } catch (Exception e) {
                e.printStackTrace();
            }
        });
    }

    @Override
    public void stop() {

    }
}
